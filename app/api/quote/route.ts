import { NextRequest, NextResponse } from 'next/server';
import nodemailer from 'nodemailer';
export async function POST(req:NextRequest){try{const data=await req.json();const {name,company,email,phone,needs,details}=data;const transporter=nodemailer.createTransport({host:process.env.SMTP_HOST,port:Number(process.env.SMTP_PORT||587),secure:process.env.SMTP_SECURE==='true',auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}});const toEmail=process.env.QUOTE_TO_EMAIL||process.env.SMTP_USER;const info=await transporter.sendMail({from:`Ruvison Quote <${process.env.SMTP_USER}>`,to:toEmail,subject:`New Quote Request from ${name||'Unknown'}`,text:`Name: ${name}\nCompany: ${company}\nEmail: ${email}\nPhone: ${phone}\nNeeds: ${(needs||[]).join(', ')}\n\nDetails:\n${details}`});return NextResponse.json({ok:true,messageId:info.messageId});}catch(e:any){console.error('Quote API error:',e?.message||e);return NextResponse.json({ok:false,error:e?.message||'Unknown error'},{status:500});}}
